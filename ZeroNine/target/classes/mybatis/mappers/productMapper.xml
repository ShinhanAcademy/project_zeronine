<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.zeronine.product">
  <select id="selectAll" resultType="productVo">
  	select* from product
  </select>
  <select id="selectBypCategoryId" parameterType="Integer" resultType="productVo">
   SELECT *
	FROM public.product where "pCategoryId" = #{pCategoryId}
  </select>
  <select id="selectBypCategoryIdall" parameterType="Integer" resultType="productVo">
   SELECT *
	FROM public.product where "pCategoryId" != #{pCategoryId}
  </select>
  <select id="selectBymanyLiked" resultType="productVo">
select pd."pName", pd."brand", pd."price", prcount
from
product pd left join
(select "productId", count("productId") prcount from "likedProduct" group by "productId") ld
on pd."productId" = ld."productId" order by prcount desc NULLS LAST, pd.price asc
  </select>
  <select id="selectByDelivery" resultType="productVo">
  select "pd"."pName", "pd"."brand", "pd"."price"
from (select "productId", count("productId") prcount  
						from "deliveryProduct" group by "productId" ) l full outer join "product" pd  on  l."productId" = "pd"."productId" 
						order by prcount desc NULLS LAST, "pd"."price" asc ;
</select>
<select id="selectBypriceAsc" resultType="productVo">
select * from product order by price asc;
</select>
<select id="selectBypriceDesc" resultType="productVo">
select * from product order by price desc;
</select>
<select id="selectByPnameBrand" parameterType="String" resultType="productVo">
select * from product where "pName" like #{q} or "brand" like #{q}
</select>
</mapper>